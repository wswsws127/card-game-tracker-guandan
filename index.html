<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è®°ç‰Œå™¨</title>
  <style>
    #box {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
    }

    .card {
      flex: 0 0 calc(20% - 10px); /* 5 cards per row with some margin */
      aspect-ratio: 4 / 7; /* Maintain a 7:4 aspect ratio */
      margin: 1rem;
      max-height: 10rem;
      max-width: 7rem;
      position: relative;
      border-radius: 10px;
      background-color: #f5f5f5;
      box-shadow: 0 5px 5px 0 #c9c9c9;
      font-size: 36px;
      /* å¢å¤§å­—ä½“å¤§å° */
      display: flex;
      flex-direction: column;
      /* å‚ç›´å¸ƒå±€ */
      align-items: center;
      justify-content: space-between;
      /* é¡¶éƒ¨å±…ä¸­æ•°å­—ï¼Œåº•éƒ¨æŒ‰é’® */
      padding: 0;
      /* å»æ‰å¤šä½™é—´è· */
      text-align: center;
    }

    #box {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: stretch;
      user-select: none;
      padding: 10px;
    }

    .card--empty {
      color: #c3c3c3;
      opacity: 0.8;
    }

    .card--chosen {
      margin-top: 0;
    }

    .btn-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: auto;
      /* è‡ªåŠ¨å‘åº•éƒ¨æ¨ */
      padding-bottom: 10px;
      /* ä¸å¡ç‰‡åº•éƒ¨ç•™ä¸€å®šé—´è· */
    }

    .ctrl-btn {
      background-color: transparent;
      color: darkred;
      border: none;
      font-size: 18px;
      padding: 1px;
      cursor: pointer;
      transition: transform 0.3s ease;
      outline: none;
      margin: 0 5px;
    }

    .ctrl-btn:active {
      transform: scale(0.9);
    }

    .ctrl-btn:hover {
      color: red;
    }

    .card--warning .card-count {
      color: darkred;
      font-weight: bold;
    }

    @media (max-width: 600px) {
      .card {
        width: 30%;
        /* åŠ¨æ€è°ƒæ•´å®½åº¦ä»¥é€‚åº”å±å¹• */
        height: auto;
        padding-bottom: 10px;
      }

      .ctrl-btn {
        font-size: 20px;
        /* è°ƒæ•´æŒ‰é’®å¤§å°ä½¿ä¹‹é€‚åˆå±å¹• */
      }

      .card-count {
        font-size: 20px;
        /* åŒæ ·è°ƒæ•´å­—å· */
      }
    }

    .info {
      font-size: 14px;
      text-align: center;
      color: #999;
      margin-top: 20px;
      /* è°ƒæ•´é—´è·ä»¥é€‚åº”ä¸åŒå±å¹• */
    }

    .input-container {
      text-align: center;
      margin-top: 20px;
    }

    #cardInput {
      width: 80%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
      outline: none;
    }

    .card-count {
      font-size: 18px;
      font-weight: bold;
      transition: color 0.3s ease;
    }

    .card-value {
      position: absolute;
      top: 45%;
      /* å‚ç›´å±…ä¸­ */
      left: 50%;
      /* æ°´å¹³å±…ä¸­ */
      transform: translate(-50%, -50%);
      /* è°ƒæ•´å±…ä¸­åç§» */
      font-size: 48px;
      /* å­—ä½“å¤§å° */
      font-weight: bold;
      /* åŠ ç²—æ˜¾ç¤º */
      color: black;
      /* æ•°å­—é¢œè‰² */
      pointer-events: none;
      /* ç¦æ­¢äº¤äº’ï¼Œé˜²æ­¢å½±å“æŒ‰é’®ç‚¹å‡» */
    }

    /* æ•°å­—ä¸æŒ‰é’®çš„é¢œè‰²å®šä¹‰ */
    /* æ·±çº¢è‰²ï¼ˆåº“å­˜ > 4ï¼‰ */
    .card.high .card-count,
    .card.high .ctrl-btn {
      color: darkred;
    }

    /* çº¢è‰²ï¼ˆåº“å­˜ = 4ï¼‰ */
    .card.medium .card-count,
    .card.medium .ctrl-btn {
      color: red;
    }

    /* æ·±é»„è‰²ï¼ˆåº“å­˜ <= 4 ä¸” > 0ï¼‰ */
    .card.low .card-count,
    .card.low .ctrl-btn {
      color: #ffc72c;
    }

    /* ç»¿è‰²ï¼ˆåº“å­˜ = 0ï¼‰ */
    .card.empty .card-count,
    .card.empty .ctrl-btn {
      color: green;
    }

    /* æŒ‰é’®ç‚¹å‡»å’Œæ‚¬åœæ•ˆæœä¿æŒ */
    .ctrl-btn:active {
      transform: scale(0.9);
    }

    #resetBtn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #f5f5f5;
      color: darkred;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    #resetBtn:hover {
      background-color: #ffc72c;
    }

    #analysisBox {
      padding: 10px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
      font-size: 16px;
      color: #333;
      background-color: #f9f9f9;
    }

    #analysisBox p {
      margin: 5px 0;
    }

    #historyLog {
      color: grey;
      margin-top: 1rem;
    }

    .bomb-button {
      position: absolute;
      top: 5px;
      right: 5px;
    }
  </style>

  <title>ä¸€é”®æˆªå›¾å¹¶è¯†åˆ«</title>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
  <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
</head>

<body>
  <div id="box"></div>
  <div class="info">
    <p>ä½œè€…: <a href="http://www.leelei.info">GPT + wswsws125</a></p>
    <p>ç”¨æ³•: ã€ç‚¹å‡»ã€‘ç®­å¤´å¢å‡ç‰Œï¼Œæˆ–ç›´æ¥è¾“å…¥ç‰Œç‚¹</p>
    <div class="input-container">
      <input id="cardInput" type="text" placeholder="è¾“å…¥ç‰Œç‚¹ï¼ˆå¦‚555666æˆ–kkï¼‰ï¼ŒæŒ‰å›è½¦å‡å»åº“å­˜">


      <button id="captureButton">ä¸€é”®æˆªå›¾å¹¶è¯†åˆ«</button>
      <div id="historyLog"></div>
      <p id="ocrResult">è¯†åˆ«ç»“æœï¼š</p>
      <script>
        document.getElementById('captureButton').addEventListener('click', async () => {
          try {
            // ä½¿ç”¨ html2canvas æˆªå›¾
            const canvas = await html2canvas(document.body); // æˆªå›¾æ•´ä¸ªé¡µé¢
            const imageData = canvas.toDataURL('image/png'); // è½¬æ¢ä¸º PNG å›¾ç‰‡

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('ocrResult').innerText = 'æ­£åœ¨è¯†åˆ«ï¼Œè¯·ç¨å€™...';

            // ä½¿ç”¨ tesseract.js è¿›è¡Œ OCR è¯†åˆ«
            const worker = Tesseract.createWorker(); // åˆ›å»º Worker
            await worker.loadLanguage('eng'); // åŠ è½½è¯­è¨€åŒ…
            await worker.initialize('eng'); // åˆå§‹åŒ–è¯­è¨€

            const { data: { text } } = await worker.recognize(imageData); // è¯†åˆ«å›¾ç‰‡
            document.getElementById('ocrResult').innerText = `è¯†åˆ«ç»“æœï¼š\n${text}`; // æ˜¾ç¤ºç»“æœ

            await worker.terminate(); // ç»“æŸä»»åŠ¡
          } catch (error) {
            console.error('æˆªå›¾æˆ–è¯†åˆ«å¤±è´¥', error);
            document.getElementById('ocrResult').innerText = 'è¯†åˆ«å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚';
          }
        });

      </script>

    </div>
    <br>
    <div id="analysisBox">
      <p><strong>å¯¹æ‰‹å¯èƒ½å­˜åœ¨çš„å¤§ç‰Œï¼š</strong></p>
      <p id="threePairs">ä¸‰è¿å¯¹ï¼š</p>
      <p id="steelPlates">é’¢æ¿ï¼š</p>
      <p id="sequences">é¡ºå­ï¼š</p>
      <p id="fourBombs">å››ç‚¸ï¼š</p>
      <p id="fiveBombs">äº”ç‚¸ï¼š</p>
      <p id="sixBombs">å…­ç‚¸ï¼š</p>
      <p id="sevenBombs">ä¸ƒç‚¸ï¼š</p>
      <p id="eightBombs">å…«ç‚¸ï¼š</p>
      <p id="heavenlyKingBomb">å¤©ç‹ç‚¸ï¼šæ— </p> <!-- æ–°å¢ -->
    </div>

    <button id="resetBtn">Reset</button>

  </div>

  <script>
    // å®šä¹‰å¡ç‰‡æ•°æ®ç»“æ„ï¼Œå°†ç‰Œç‚¹å’Œåº“å­˜ç»‘å®šåœ¨ä¸€èµ·
    const cards = {
      'ğŸ‘‘': 2, // å¤§ç‹
      'âš”': 2, // å°ç‹
      'A': 8,
      'K': 8,
      'Q': 8,
      'J': 8,
      '10': 8,
      '9': 8,
      '8': 8,
      '7': 8,
      '6': 8,
      '5': 8,
      '4': 8,
      '3': 8,
      '2': 8,
    };

    // å®šä¹‰ç‰Œç‚¹çš„æ˜¾ç¤ºé¡ºåº
    const cardOrder = ['ğŸ‘‘', 'âš”', 'A', 'K', 'Q', 'J', '10', '9', '8', '7', '6', '5', '4', '3', '2'];

    const maxNums = [2, 2, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]; // æ¯å¼ ç‰Œçš„æœ€å¤§å¼ æ•°
    const nums = [...maxNums]; // å½“å‰å¼ æ•°æ•°ç»„ï¼Œåˆå§‹åŒ–ä¸ºæœ€å¤§å¼ æ•°
    const TYPE_CHOSEN = ' card--chosen';
    const TYPE_WARNING = ' card--warning';
    const TYPE_EMPTY = ' card--empty';
    let levelCard = null; // å®šä¹‰çº§ç‰Œçš„å…¨å±€å˜é‡


    function addClass(e, name) {
      if (e.className.indexOf(name) === -1) {
        e.className += name;
      }
    }

    function removeClass(e, name) {
      e.className = e.className.replace(name, '');
    }

    function initCards() {
      let box = document.getElementById('box');
      let frag = document.createDocumentFragment();

      // æŒ‰ç…§ cardOrder çš„é¡ºåºéå†
      for (let i = 0; i < cardOrder.length; i++) {
        let cardName = cardOrder[i];
        if (!cards[cardName]) continue; // å¦‚æœ cards ä¸­æ²¡æœ‰è¿™ä¸ªç‰Œï¼Œè·³è¿‡

        let ele = document.createElement('div');
        ele.className = 'card high'; // é»˜è®¤é«˜åº“å­˜
        ele.style.position = 'relative'; // æ·»åŠ ç›¸å¯¹å®šä½
        ele.setAttribute('data-card', cardName); // ä½¿ç”¨å¡ç‰‡åç§°ä½œä¸ºæ ‡è¯†

        // æ·»åŠ ç‰Œé¢æ•°å­—
        let faceValue = document.createElement('span');
        faceValue.className = 'card-value';
        faceValue.innerText = cardName;
        ele.appendChild(faceValue);

        // åˆ›å»ºæŒ‰é’®å®¹å™¨
        let btnContainer = document.createElement('div');
        btnContainer.className = 'btn-container';

        // æ·»åŠ å¢åŠ æŒ‰é’®
        let increaseBtn = document.createElement('button');
        increaseBtn.className = 'ctrl-btn increase-btn';
        increaseBtn.id = `increase-${i}`; // ä¸ºæ¯ä¸ªæŒ‰é’®æ·»åŠ å”¯ä¸€ ID
        increaseBtn.innerHTML = '&#9650;'; // ä¸Šç®­å¤´
        increaseBtn.addEventListener('click', () => changeCount(ele, 1)); // å¢åŠ æ•°é‡

        // æ·»åŠ æ˜¾ç¤ºå½“å‰æ•°é‡
        let countDisplay = document.createElement('span');
        countDisplay.className = 'card-count';
        countDisplay.innerText = cards[cardName];

        // æ·»åŠ å‡å°‘æŒ‰é’®
        let decreaseBtn = document.createElement('button');
        decreaseBtn.className = 'ctrl-btn decrease-btn';
        decreaseBtn.id = `decrease-${i}`; // ä¸ºæ¯ä¸ªæŒ‰é’®æ·»åŠ å”¯ä¸€ ID
        decreaseBtn.innerHTML = '&#9660;'; // ä¸‹ç®­å¤´
        decreaseBtn.addEventListener('click', () => changeCount(ele, -1)); // å‡å°‘æ•°é‡

        // æ·»åŠ ç‚¸å¼¹æŒ‰é’®
        let bombBtn = document.createElement('button');
        bombBtn.className = 'bomb-button ctrl-btn';
        bombBtn.innerHTML = '&#128163;'; // ç‚¸å¼¹å›¾æ ‡
        bombBtn.addEventListener('click', () => changeCount(ele, -4)); // å‡å°‘æ•°é‡
        if(cardName !== 'ğŸ‘‘' && cardName !== 'âš”'){
          btnContainer.appendChild(bombBtn);
        }

        // å°†æŒ‰é’®æ·»åŠ åˆ°å®¹å™¨
        btnContainer.appendChild(increaseBtn);
        btnContainer.appendChild(countDisplay);
        btnContainer.appendChild(decreaseBtn);

        ele.appendChild(btnContainer);

        // æ·»åŠ å¡ç‰‡åˆ°æ–‡æ¡£ç‰‡æ®µ
        frag.appendChild(ele);
      }

      // æ·»åŠ æ‰€æœ‰å¡ç‰‡åˆ°é¡µé¢
      box.appendChild(frag);

      // è°ƒç”¨åˆ†ææ–¹æ³•ï¼Œæ›´æ–°ç‰Œç»„ä¿¡æ¯
      analyzeRemainingCards();
    }


    function changeCount(card, delta) {
      let countDisplay = card.querySelector('.card-count');
      let faceValue = card.querySelector('.card-value'); // å¡ç‰‡çš„ç‰Œå€¼æ˜¾ç¤º
      let increaseBtn = card.querySelector('.increase-btn'); // è·å–ä¸Šç®­å¤´æŒ‰é’®
      let decreaseBtn = card.querySelector('.decrease-btn'); // è·å–ä¸‹ç®­å¤´æŒ‰é’®
      let bombBtn = card.querySelector('.bomb-button'); // è·å–ç‚¸å¼¹æŒ‰é’®
      let cardValue = card.querySelector('.card-value').innerText; // è·å–å½“å‰ç‰Œçš„åç§°
      let cardIndex = cardOrder.indexOf(cardValue); // ä» cardOrder è·å–ç´¢å¼•
      let newCount = cards[cardValue] + delta; // æ ¹æ®ç‰Œåä» cards å¯¹è±¡ä¸­è°ƒæ•´æ•°é‡

      // æ£€æŸ¥æ˜¯å¦åœ¨æœ‰æ•ˆèŒƒå›´å†…
      if (newCount >= 0 && newCount <= maxNums[cardIndex]) { // ä½¿ç”¨æ­£ç¡®çš„ç´¢å¼•
        cards[cardValue] = newCount; // æ›´æ–°å½“å‰å¼ æ•°
        countDisplay.innerText = newCount; // æ›´æ–°å¡ç‰‡æ˜¾ç¤ºçš„æ•°å­—
        card.setAttribute('count', newCount); // æ›´æ–°å¡ç‰‡å±æ€§å€¼

        // æ›´æ–°é¢œè‰²ç±»
        card.classList.remove('high', 'medium', 'low', 'empty');
        if (newCount > 4) {
          card.classList.add('high'); // æ·±çº¢è‰²
        } else if (newCount == 4) {
          card.classList.add('medium'); // çº¢è‰²
        } else if (newCount > 0) {
          card.classList.add('low'); // é»„è‰²
        } else {
          card.classList.add('empty'); // ç°è‰²
        }

        // æ›´æ–°æ ·å¼
        if (newCount <= 0) {
          newCount = 0; // ç¡®ä¿æ•°é‡ä¸å°äº0
          faceValue.style.color = 'lightgray';
          countDisplay.style.color = 'lightgray'; // è°ƒæ•´æ•°å­—é¢œè‰²
          increaseBtn.style.color = 'lightgray'; // è°ƒæ•´ä¸Šç®­å¤´é¢œè‰²
          decreaseBtn.style.color = 'lightgray'; // è°ƒæ•´ä¸‹ç®­å¤´é¢œè‰²
        } else {
          card.classList.remove('empty'); // ç§»é™¤ç©ºåº“å­˜ç±»
          faceValue.style.color = '';
          countDisplay.style.color = ''; // æ¢å¤é»˜è®¤é¢œè‰²
          increaseBtn.style.color = ''; // æ¢å¤ä¸Šç®­å¤´é¢œè‰²
          decreaseBtn.style.color = ''; // æ¢å¤ä¸‹ç®­å¤´é¢œè‰²
        }


        // è°ƒç”¨åˆ†ææ–¹æ³•æ›´æ–°æ˜¾ç¤º
        analyzeRemainingCards();
      }
    }

    function handleInput(event) {
      if (event.key === "Enter") {
        const input = event.target.value.replace(/\s+/g, '').toUpperCase(); // ç§»é™¤æ‰€æœ‰ç©ºæ ¼å¹¶è½¬æ¢ä¸ºå¤§å†™

        // å®šä¹‰ç‰¹æ®Šæ˜ å°„è§„åˆ™
        const specialMap = {
          '1': 'A',  // 1 ä»£è¡¨ A
          'D': 'ğŸ‘‘', // D ä»£è¡¨å¤§ç‹
          'X': 'âš”', // X ä»£è¡¨å°ç‹
          'S': '10'  // S ä»£è¡¨ 10
        };

        // è½¬æ¢è¾“å…¥ï¼Œå°†ç‰¹æ®Šå­—ç¬¦æ›¿æ¢ä¸ºå¯¹åº”ç‰Œç‚¹
        const normalizedInput = [...input].map(char => specialMap[char] || char);

        // åˆå§‹åŒ–è¾“å…¥ç»Ÿè®¡
        const inputCounts = {};

        // éå†è¾“å…¥ï¼Œç»Ÿè®¡æ¯ç§ç‰Œç‚¹çš„æ•°é‡
        for (let char of normalizedInput) {
          if (cards[char] !== undefined) {
            inputCounts[char] = (inputCounts[char] || 0) + 1;
          } else {
            alert(`æ— æ•ˆè¾“å…¥: ${char}`);
            return; // é‡åˆ°æ— æ•ˆè¾“å…¥ç›´æ¥è¿”å›
          }
        }

        // æ£€æŸ¥åº“å­˜æ˜¯å¦è¶³å¤Ÿ
        for (let card in inputCounts) {
          if (inputCounts[card] > cards[card]) {
            alert(`åº“å­˜ä¸è¶³: ${card} (${inputCounts[card]} å¼ éœ€è¦ï¼Œåº“å­˜ä»…æœ‰ ${cards[card]} å¼ )`);
            return;
          }
        }

        // æ›´æ–°åº“å­˜
        for (let card in inputCounts) {
          cards[card] -= inputCounts[card]; // å‡åº“å­˜
          updateCardUI(card); // æ›´æ–° UI
        }

        event.target.value = ""; // æ¸…ç©ºè¾“å…¥æ¡†

        // è°ƒç”¨åˆ†ææ–¹æ³•ï¼Œæ›´æ–°ç‰Œç»„ä¿¡æ¯
        analyzeRemainingCards();
      }
    }

    // æ›´æ–°å•å¼ å¡ç‰‡çš„ UI
    function updateCardUI(card) {
      const cardElement = document.querySelector(`.card[data-card="${card}"]`);
      const countElement = cardElement.querySelector('.card-count');
      countElement.textContent = cards[card];

      // æ›´æ–°é¢œè‰²çŠ¶æ€
      cardElement.classList.remove('high', 'medium', 'low', 'empty');
      if (cards[card] > 4) {
        cardElement.classList.add('high');
      } else if (cards[card] === 4) {
        cardElement.classList.add('medium');
      } else if (cards[card] > 0) {
        cardElement.classList.add('low');
      } else {
        cardElement.classList.add('empty');
      }
    }

    let history = [];

    function updateHistoryLog(newInput) {
      history.unshift(newInput); // Add the new input at the beginning
      document.getElementById('historyLog').innerText = history.join(', ');
    }

    function handleInput(event) {
      if (event.key === "Enter") {
        const input = event.target.value.replace(/\s+/g, '').toUpperCase(); // ç§»é™¤æ‰€æœ‰ç©ºæ ¼å¹¶è½¬æ¢ä¸ºå¤§å†™
        updateHistoryLog(input); // Update the history log with the new input
        const specialMap = {
          '1': 'A',  // 1 ä»£è¡¨ A
          'D': 'ğŸ‘‘', // D ä»£è¡¨å¤§ç‹
          'X': 'âš”', // X ä»£è¡¨å°ç‹
          'S': '10'  // S ä»£è¡¨ 10
        };

        const normalizedInput = [...input].map(char => specialMap[char] || char);

        const inputCounts = {};

        for (let char of normalizedInput) {
          if (cards[char] !== undefined) {
            inputCounts[char] = (inputCounts[char] || 0) + 1;
          } else {
            alert(`æ— æ•ˆè¾“å…¥: ${char}`);
            return; 
          }
        }

        for (let card in inputCounts) {
          if (inputCounts[card] > cards[card]) {
            alert(`åº“å­˜ä¸è¶³: ${card} (${inputCounts[card]} å¼ éœ€è¦ï¼Œåº“å­˜ä»…æœ‰ ${cards[card]} å¼ )`);
            return;
          }
        }

        for (let card in inputCounts) {
          cards[card] -= inputCounts[card]; 
          updateCardUI(card); 
        }

        event.target.value = ""; 

        analyzeRemainingCards();
      }
    }

    function analyzeRemainingCards() {
      const remainingCounts = Object.entries(cards)
        .map(([card, count]) => ({ card, count }));

      const threePairs = [];
      for (let i = 2; i <= cardOrder.length - 3; i++) { 
        if (
          cards[cardOrder[i]] >= 2 &&
          cards[cardOrder[i + 1]] >= 2 &&
          cards[cardOrder[i + 2]] >= 2
        ) {
          const triplet = [
            cardOrder[i], cardOrder[i],
            cardOrder[i + 1], cardOrder[i + 1],
            cardOrder[i + 2], cardOrder[i + 2],
          ];
          threePairs.push(sortByCardOrder(triplet).join(''));
        }
      }

      const steelPlates = [];
      for (let i = 2; i <= cardOrder.length - 2; i++) { 
        if (
          cards[cardOrder[i]] >= 3 &&
          cards[cardOrder[i + 1]] >= 3
        ) {
          const plate = [
            cardOrder[i], cardOrder[i], cardOrder[i],
            cardOrder[i + 1], cardOrder[i + 1], cardOrder[i + 1],
          ];
          steelPlates.push(sortByCardOrder(plate).join(''));
        }
      }

      const sequences = [];
      for (let i = 2; i <= cardOrder.length - 5; i++) { 
        if (
          cards[cardOrder[i]] >= 1 &&
          cards[cardOrder[i + 1]] >= 1 &&
          cards[cardOrder[i + 2]] >= 1 &&
          cards[cardOrder[i + 3]] >= 1 &&
          cards[cardOrder[i + 4]] >= 1
        ) {
          const sequence = [
            cardOrder[i],
            cardOrder[i + 1],
            cardOrder[i + 2],
            cardOrder[i + 3],
            cardOrder[i + 4],
          ];
          sequences.push(sortByCardOrder(sequence).join(''));
        }
      }

      analyzeHeavenlyKingBomb();

      updateBombsDisplay();

      document.getElementById('threePairs').innerText = `ä¸‰è¿å¯¹ï¼š${threePairs.join(', ') || 'æ— '}`;
      document.getElementById('steelPlates').innerText = `é’¢æ¿ï¼š${steelPlates.join(', ') || 'æ— '}`;
      document.getElementById('sequences').innerText = `é¡ºå­ï¼š${sequences.join(', ') || 'æ— '}`;
    }

    function getBombs(n) {
      return Object.entries(cards)
        .filter(([_, count]) => count >= n)
        .map(([card, count]) => `${n}ä¸ª${card}`);
    }

    function analyzeHeavenlyKingBomb() {
      const hasHeavenlyKingBomb = cards['ğŸ‘‘'] >= 2 && cards['âš”'] >= 2;
      document.getElementById('heavenlyKingBomb').innerText = `å¤©ç‹ç‚¸ï¼š${hasHeavenlyKingBomb ? 'æœ‰' : 'æ— '}`;
    }

    function updateBombsDisplay() {
      const bombLevels = [4, 5, 6, 7, 8]; 
      const bombElements = [
        'fourBombs',
        'fiveBombs',
        'sixBombs',
        'sevenBombs',
        'eightBombs',
      ]; 

      bombLevels.forEach((level, index) => {
        const bombs = getBombs(level); 
        document.getElementById(bombElements[index]).innerText = `${level}ç‚¸ï¼š${bombs.join(', ') || 'æ— '}`;
      });
    }

    function sortByCardOrder(cards) {
      return cards.sort((a, b) => cardOrder.indexOf(a) - cardOrder.indexOf(b));
    }

    function resetAll() {
      for (const card in cards) {
        cards[card] = card === 'ğŸ‘‘' || card === 'âš”' ? 2 : 8; // Reset to default values
      }
      // Clear the card container to avoid duplicate additions
      const box = document.getElementById('box');
      box.innerHTML = '';
      initCards(); // Reinitialize cards

      // Clear the history log
      history = []; // Clear history array
      document.getElementById('historyLog').innerText = ''; // Clear history log
    }
    document.getElementById('resetBtn').addEventListener('click', resetAll);

    window.onload = function () {
      initCards();
      document.getElementById("cardInput").addEventListener("keydown", handleInput);
      document.getElementById("resetBtn").addEventListener("click", resetAll);
    };

    document.addEventListener('dblclick', function (event) {
      event.preventDefault();
    }, { passive: false });
  </script>
</body>

</html>